# Summary: N(X; mean(k), covar(k))
def map_gaussian_pdf(x):
    # x: (instance_index, gaussian_index)

    inst_idx = x[0]
    g_mean_idx = x[1]
    g_covar_idx = x[1]

    X = data_np[inst_idx] # data instance 
    mean = means[g_mean_idx] # gaussian mean
    covar = variances[g_covar_idx] # gaussian covariance

    X_sub_mean_square = np.square(np.subtract(X, mean)) 
    X_sub_mean_div_covar = np.divide(X_sub_mean_square, covar)
    sum_X_sub_mean_div_covar = np.sum(X_sub_mean_div_covar)


    two_pi_d = np.multiply(np.power(np.pi, num_cattr), 2)
    two_pi_d_ln = np.log(two_pi_d)


    covar_ln = np.log(np.array(covar))
    det_covar_ln = np.sum(covar_ln)


    ln_one_div_root_two_pi_d_det_covar = (-0.5) * (two_pi_d_ln + det_covar_ln)


    ln_res = (ln_one_div_root_two_pi_d_det_covar)+((-0.5)*sum_X_sub_mean_div_covar)
    res = np.power(np.e, ln_res)

    # To check for error
    if res == 0.0:
        print "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"

        print ("inst_idx", inst_idx, X)
        print ("g_mean_idx", g_mean_idx, mean)
        print ("two_pi_d", two_pi_d, two_pi_d_ln)
        print ("covar", covar, covar_ln)
        print ("det_covar_ln", det_covar_ln)
        print ("ln_one_div_root_two_pi_d_det_covar", ln_one_div_root_two_pi_d_det_covar)
        print ("sum_X_sub_mean_div_covar", sum_X_sub_mean_div_covar)
        print ("ln_res", ln_res)
        print ("res", res)

        print "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"

    # Return the key and the result as a tuple to be stored in a dictionary later
    return (x, res)



###########################################################################
# Error printout example:

('inst_idx', 5, array([ -5.4541372,  -6.3348188,  -8.5325147,  -8.1690327,  -7.9743324,
        -8.3217221, -10.112098 ,  -7.3541053,  -6.4468209,  -6.1336867,
        -5.3341077,  -4.6547752,  -4.7831172,  -4.4036085,  -4.2827438,
        -4.5132966,  -4.9298932,  -4.9052549,  -5.1986616,  -5.3153235,
        -3.5154279,  -3.5085755,  -3.9370302,  -4.0681045,  -4.0600664,
        -4.1407766,  -5.1029274,  -4.1550604,  -4.7890987,  -5.7877245,
        -4.8741899,  -4.3220012,  -4.8625038,  -5.3833566,  -5.7947724,
        -5.6001509,  -4.7424754,  -4.9588752,  -7.6626268,  -5.8614963,
        -5.5195118,  -5.3526724,  -4.6910311,  -4.915951 ,  -6.4370655,
        -6.6921206,  -5.7352603,  -4.8633175,  -5.1450934,  -8.2464275,
        -7.0991403,  -6.1972532,  -5.7415247,  -5.2361154,  -5.7906775,
        -6.3820678,  -7.0994206,  -6.4354005,  -7.501221 ,  -7.0469467,
        -7.1767696,  -7.0086177,  -5.2724356,  -4.9942951,  -6.1809774,
        -7.3335614,  -8.236734 ,  -7.2995571,  -6.2442578,  -6.1554357,
        -6.1968288,  -6.1648632,  -7.264379 ,  -8.8723557,  -6.9293202,
        -7.1659177,  -7.4957376,  -7.6958972,  -6.8197998,  -6.7215158,
        -7.5056039,  -6.4653367,  -6.7003457,  -7.224014 ,  -6.1751074,
        -5.8177292,  -6.08459  ,  -6.1014927,  -7.0146045,  -7.2718892,
        -6.8680556,  -6.2352493,  -5.78167  ,  -6.7468155,  -7.0732442,
        -7.460184 ,  -6.2324073,  -6.160996 ,  -6.4954108,  -7.1038367,
        -7.870047 ,  -7.0541021,  -8.5234409,  -7.3852567,  -6.8303593,
        -5.8695515,  -6.1050593,  -6.4471876,  -6.391788 ,  -6.3794113,
        -6.936393 ,  -7.875587 ,  -6.4616988,  -7.5187808,  -6.9465259,
        -6.6787738,  -6.2018256,  -6.451867 ,  -7.8913076,  -7.6071111,
        -9.3946233,  -7.2917833,  -6.7700729,  -7.5560925,  -6.3772273,
        -6.2371486,  -6.5294119,  -6.9370291,  -6.7192667,  -6.1069703,
        -6.0393372,  -6.1351313,  -6.1506193,  -6.2418472,  -6.5751816,
        -6.5472532,  -6.4618003,  -6.8913107,  -7.9931579,  -6.4506621,
        -7.0003596,  -6.974422 ,  -6.7171796,  -8.6863615,  -6.86222  ,
        -5.588935 ,  -5.8062705,  -6.0468523,  -5.9937739,  -5.7253148,
        -5.2579238,  -5.6556969,  -6.1004878,  -7.4001906,  -8.1754986,
        -7.6313947,  -7.7375157,  -7.0668542,  -8.6329081,  -6.8846125,
        -7.7512295,  -7.0886975,  -7.0724925,  -6.8976904,  -7.3430074,
        -8.9994752,  -7.420949 ,  -7.3854923,  -7.6446441,  -7.2745968,
        -7.3744343,  -7.8976672,  -8.0587589,  -7.1597238,  -6.3232547,
        -6.5962579,  -8.0516887,  -8.9123578,  -8.1933583,  -6.8317388,
        -6.3360923,  -6.7843179,  -7.6459682,  -7.3152362,  -7.4240093,
        -7.0883302,  -7.7186642,  -7.561003 ,  -7.7894649,  -7.2338641,
        -6.6880043,  -6.9361043,  -7.3035917,  -8.2219614,  -7.6366623,
        -7.3165827,  -8.0119256,  -7.7959182,  -8.1217876,  -7.8689274,
        -8.1280502,  -7.6329474,  -7.1296204,  -7.9914371,  -7.4565978,
        -6.9998001,  -7.2311023,  -7.393407 ,  -8.5268259,  -7.2451737,
        -8.0786456,  -8.5204944,  -7.4716568,  -7.0329541,  -6.5013944,
        -7.2165591,  -7.4448112,  -6.9533302,  -7.3924024,  -8.0785194,
        -7.1110476,  -7.7120102,  -8.6294713,  -7.9593741,  -8.1122136,
        -7.7985299,  -8.0338895,  -7.2846802,  -7.698694 ,  -7.7393548,
        -7.0727871,  -7.2889757,  -7.1261166,  -8.7812221,  -7.7407266,
        -7.260231 ,  -6.9412721,  -7.345067 ,  -8.2609594,  -7.4460589,
        -7.0429402,  -6.5733425,  -7.097843 ,  -7.7008845,  -8.6333593,
        -8.1645951,  -8.5894409,  -8.3110594,  -7.8055231,  -8.5919549,
        -8.6303172,  -8.8852725,  -8.7287383,  -9.016194 ,  -9.3609448,
        -9.7191109,  -9.7681058]))
('g_mean_idx', 21, array([ 0.00532979, -0.31602151, -0.90787464, -0.93158912, -0.94577765,
       -0.95748845, -0.98712225, -1.02560192, -0.99387047, -0.97198497,
       -0.81246721, -0.69987809, -0.74385333, -0.88957628, -0.90283458,
       -0.81115707, -0.81033691, -0.88594819, -0.82775912, -0.67220052,
       -0.77576467, -0.82536283, -0.8371019 , -0.73732956, -0.80585301,
       -0.82949836, -0.79032269, -0.78400048, -0.77909778, -0.77322693,
       -0.76061244, -0.70425897, -0.57306157, -0.68338635, -0.78160206,
       -1.06559269, -0.86398476, -0.7102965 , -0.79075041, -0.7299263 ,
       -0.79153924, -0.77991794, -0.74895307, -0.75037719, -0.87148058,
       -0.83112706, -0.77379813, -0.72930124, -0.76991936, -0.86240294,
       -0.8624222 , -0.82186501, -0.81002568, -0.53989355, -0.6030902 ,
       -0.75177194, -0.83796784, -0.86157944, -0.85575859, -0.82946577,
       -0.85320935, -0.94478634, -0.89613173, -0.66600115, -0.78971879,
       -0.83713946, -0.84585323, -0.85916142, -0.8183282 , -0.80907833,
       -0.81648106, -0.92269293, -0.86713007, -0.77910079, -0.80473969,
       -0.80703702, -0.82027564, -0.82469099, -0.80345816, -0.82462852,
       -0.82082661, -0.83154822, -0.82573022, -0.82144602, -0.83048043,
       -0.6981841 , -0.72631388, -0.82549887, -0.81767969, -0.80939864,
       -0.80956424, -0.68392522, -0.50287845, -0.72283912, -0.82155789,
       -0.83574757, -0.66132694, -0.60443983, -0.81365389, -0.79517481,
       -0.76021479, -0.62068497, -0.73396972, -0.84575354, -0.79991299,
       -0.74712916, -0.83453037, -0.83635043, -0.81890232, -0.85811689,
       -0.89626648, -0.89309051, -0.90189327, -0.90690623, -0.89591359,
       -0.80483742, -0.88831178, -0.88981054, -0.91556361, -0.90685741,
       -0.93538215, -0.95383688, -0.93757468, -0.8914701 , -0.86050804,
       -0.92274675, -0.92165529, -0.91203658, -0.91755493, -0.92749506,
       -0.9285161 , -0.95698573, -0.97901845, -0.97258188, -0.95448651,
       -0.94533709, -0.91079996, -0.94178408, -0.95107621, -0.94872741,
       -0.92886903, -0.96383589, -0.99375471, -0.99556504, -0.83258949,
       -0.63399907, -0.81877922, -0.92841812, -0.95398846, -0.82211814,
       -0.79139976, -0.95460515, -0.97191821, -0.95227721, -0.93155611,
       -0.97045904, -0.93625479, -0.94966928, -0.93377324, -0.89295941,
       -0.9759426 , -0.96686105, -0.93983269, -0.93753168, -0.97197888,
       -0.97251529, -0.95580932, -0.95604623, -0.94050733, -0.95172506,
       -0.91331495, -0.93044038, -0.93952816, -0.93194099, -0.92817575,
       -0.94092522, -0.94822079, -0.94887625, -0.92575695, -0.92148311,
       -0.94477167, -0.94820814, -0.94277716, -0.95391748, -0.94560728,
       -0.95363858, -0.9289828 , -0.88748303, -0.93511348, -0.95186391,
       -0.94957987, -0.94318114, -0.92788179, -0.91831948, -0.92371971,
       -0.89229924, -0.90489422, -0.97008149, -0.96408276, -0.95781602,
       -0.96454742, -0.95408274, -0.94275257, -0.93774042, -0.92356478,
       -0.94179199, -0.94395469, -0.91230346, -0.93959342, -0.93797147,
       -0.92691953, -0.91221423, -0.90410266, -0.90094514, -0.94199324,
       -0.95404465, -0.93875092, -0.94238212, -0.94120797, -0.92665341,
       -0.92980358, -0.894379  , -0.91818427, -0.92694588, -0.92281363,
       -0.9168777 , -0.91427826, -0.90534674, -0.89891691, -0.88178976,
       -0.85746693, -0.90449262, -0.91537882, -0.90247164, -0.88913349,
       -0.90309073, -0.89963646, -0.8938496 , -0.86485603, -0.88110532,
       -0.88335064, -0.89052716, -0.88923663, -0.88723239, -0.87610305,
       -0.88671901, -0.86527187, -0.85332499, -0.89775876, -0.89047214,
       -0.89492525, -0.87226112, -0.87039741, -0.85881975, -0.82273736,
       -0.74877612, -0.49711381]))
('two_pi_d', 1.1709740696658562e+128, 294.8887278438558)
('covar', array([ 0.48890571,  0.6086416 ,  2.40389251,  2.31347521,  2.39908171,
        2.63828801,  2.85798629,  2.41283576,  2.89915929,  3.98011763,
        3.32076489,  2.53222973,  2.67054584,  3.00834892,  2.95241856,
        2.98715389,  3.17536286,  3.16965292,  2.9289785 ,  2.855272  ,
        3.04086511,  1.89646347,  2.06427967,  3.08677219,  3.69239054,
        3.32565568,  3.13229171,  3.44918717,  3.36306037,  3.38038215,
        3.3877342 ,  2.88585002,  1.94745979,  2.60090653,  3.20957193,
        2.73742374,  2.20271173,  2.93435474,  3.46479811,  3.23934319,
        3.43640349,  3.51426437,  3.1893753 ,  2.97914822,  2.99957433,
        2.90922817,  2.60811698,  2.78594109,  2.91820972,  2.95125071,
        3.13852963,  3.20027673,  3.21837209,  2.46417851,  2.43673765,
        2.80426647,  2.89477406,  2.63795978,  2.76926381,  2.86982803,
        2.88421488,  2.66294559,  2.10000396,  2.3657444 ,  2.73051503,
        2.68990918,  2.74121178,  2.69982308,  2.54060931,  2.59959339,
        2.51135084,  2.55217464,  2.39090315,  2.55829848,  2.65456378,
        2.6619643 ,  2.76257737,  2.73090771,  2.82045826,  2.93405546,
        2.92890689,  2.91493001,  2.87015619,  2.83913029,  2.85702738,
        2.52626974,  2.68164182,  2.92952665,  2.90193238,  2.72794967,
        2.8130704 ,  2.90324835,  2.73522681,  2.73495793,  2.83649065,
        3.0269273 ,  2.91702359,  2.89388739,  3.03085346,  2.92276007,
        2.68347885,  2.31917866,  2.54570587,  2.91154966,  2.91777538,
        2.77069434,  2.86724644,  2.84136811,  2.83163227,  2.90561201,
        2.96813258,  2.95614057,  3.11578772,  3.11619909,  3.16103738,
        2.96091641,  2.77138623,  2.81915689,  3.03873073,  2.85857954,
        3.1181374 ,  3.23577314,  3.2608783 ,  3.16506523,  3.0901541 ,
        3.15999336,  3.25742195,  2.94466663,  2.8913197 ,  3.16560496,
        3.20176844,  3.18777896,  3.13285215,  3.2418676 ,  3.25848027,
        3.18550701,  2.86862075,  3.20183786,  3.29565993,  3.22489965,
        3.14633097,  3.24381411,  3.26407853,  3.22075752,  3.00045072,
        2.78439061,  3.1185439 ,  3.25170069,  3.26350912,  3.18462254,
        3.11680491,  3.35109771,  3.33004021,  3.032182  ,  3.34731612,
        3.43113481,  3.41999968,  3.436367  ,  3.43262654,  3.36515748,
        3.28979374,  3.008769  ,  3.02495629,  3.3011723 ,  3.29471934,
        3.33578713,  3.34787151,  3.31135121,  3.25087444,  3.14983925,
        2.78358725,  3.04527396,  3.14565022,  3.10620913,  3.112194  ,
        3.09467673,  3.07367105,  3.05665105,  2.71568251,  2.65726128,
        2.97524702,  2.94384257,  2.94131355,  2.94836262,  2.90605868,
        2.87953148,  2.74227181,  2.44020454,  2.75269472,  2.85154789,
        2.83265139,  2.83654268,  2.82461563,  2.80121279,  2.79284538,
        2.56248265,  2.51044035,  2.8154842 ,  2.84049952,  2.84124037,
        2.85475977,  2.86878927,  2.86574058,  2.80348583,  2.50082316,
        2.76998513,  2.87191857,  2.86591112,  2.8973201 ,  2.91127531,
        2.9123761 ,  2.96110639,  2.73079851,  2.70792584,  2.99788154,
        3.0279949 ,  3.05314861,  3.03658032,  3.04561622,  3.06378894,
        3.01976362,  2.70480843,  2.97409176,  3.05937078,  3.06320451,
        3.0878327 ,  3.08734983,  3.08758843,  3.08771739,  2.86676111,
        2.81397523,  3.07069544,  3.07129938,  3.06078641,  3.06417319,
        3.02159796,  3.02936666,  2.96595245,  2.68906002,  2.92561313,
        2.99872985,  2.98946377,  2.97876706,  2.96658426,  2.94954847,
        2.9474193 ,  2.75879035,  2.65945911,  2.84349928,  2.79250399,
        2.72441   ,  2.66010648,  2.54315966,  2.37247286,  2.16337714,
        1.91223174,  2.60920206]), array([-0.71558562, -0.49652568,  0.8770893 ,  0.83875081,  0.87508604,
        0.97013023,  1.05011728,  0.88080272,  1.06442079,  1.38131137,
        1.20019515,  0.92910023,  0.98228289,  1.1013914 ,  1.08262469,
        1.09432106,  1.15542191,  1.15362209,  1.07465373,  1.04916711,
        1.11214205,  0.63999082,  0.72478134,  1.12712595,  1.30627409,
        1.20166685,  1.14176491,  1.2381386 ,  1.21285138,  1.21798876,
        1.22016132,  1.05981949,  0.66652585,  0.95586005,  1.16613757,
        1.00701724,  0.78968921,  1.07648758,  1.24265437,  1.17537059,
        1.23442543,  1.25683022,  1.15982507,  1.09163743,  1.09847039,
        1.06788781,  0.9586285 ,  1.02458573,  1.07097032,  1.08222905,
        1.14375442,  1.16323729,  1.16887567,  0.90185849,  0.89066011,
        1.031142  ,  1.06290706,  0.97000581,  1.01858151,  1.05425211,
        1.05925272,  0.97943287,  0.74193923,  0.86109273,  1.00449025,
        0.98950743,  1.00840008,  0.99318625,  0.93240394,  0.95535504,
        0.92082079,  0.93694579,  0.87167118,  0.93934238,  0.97628034,
        0.97906431,  1.01616407,  1.00463405,  1.03689937,  1.07638558,
        1.07462928,  1.06984581,  1.05436645,  1.04349777,  1.04978171,
        0.9267438 ,  0.98642923,  1.07484086,  1.06537685,  1.00355029,
        1.03427656,  1.06583023,  1.00621436,  1.00611605,  1.0425676 ,
        1.10754801,  1.07056378,  1.06260072,  1.10884425,  1.0725284 ,
        0.98711403,  0.8412131 ,  0.93440797,  1.06868547,  1.07082147,
        1.01909795,  1.05335214,  1.04428567,  1.04085332,  1.06664404,
        1.08793299,  1.08388455,  1.136482  ,  1.13661402,  1.15090026,
        1.08549882,  1.01934764,  1.03643786,  1.11143991,  1.05032484,
        1.13723584,  1.17426789,  1.18199658,  1.15217366,  1.12822096,
        1.15056992,  1.18093607,  1.07999561,  1.06171304,  1.15234418,
        1.16370329,  1.15932442,  1.14194382,  1.17614958,  1.18126091,
        1.15861146,  1.05383134,  1.16372498,  1.19260643,  1.17090183,
        1.146237  ,  1.17674983,  1.1829775 ,  1.16961659,  1.09876252,
        1.02402904,  1.13736619,  1.17917815,  1.18280303,  1.15833377,
        1.13680841,  1.20928797,  1.20298438,  1.10928249,  1.20815887,
        1.23289105,  1.22964046,  1.23441481,  1.23332572,  1.21347476,
        1.19082487,  1.10153103,  1.10689664,  1.19427765,  1.19232099,
        1.20470867,  1.20832477,  1.19735633,  1.17892402,  1.14735142,
        1.02374047,  1.11359087,  1.14602062,  1.13340305,  1.13532794,
        1.12968345,  1.12287263,  1.11731989,  0.99904331,  0.977296  ,
        1.09032707,  1.07971572,  1.07885627,  1.08124997,  1.06679776,
        1.0576276 ,  1.0087867 ,  0.89208186,  1.01258033,  1.04786197,
        1.04121316,  1.04258595,  1.0383723 ,  1.03005246,  1.02706092,
        0.94097657,  0.92045818,  1.03513425,  1.04397992,  1.04424071,
        1.0489877 ,  1.05389008,  1.05282681,  1.03086358,  0.91661994,
        1.01884195,  1.0549803 ,  1.05288632,  1.0637862 ,  1.06859124,
        1.06896928,  1.08556298,  1.00459406,  0.99618297,  1.09790589,
        1.10790065,  1.11617339,  1.11073199,  1.11370325,  1.11965236,
        1.10517856,  0.99503109,  1.0899387 ,  1.11820927,  1.11946159,
        1.12746945,  1.12731306,  1.12739034,  1.12743211,  1.05318286,
        1.03459816,  1.12190406,  1.12210072,  1.11867188,  1.11977777,
        1.10578582,  1.10835358,  1.08719821,  0.9891917 ,  1.07350408,
        1.09818881,  1.09509403,  1.09150948,  1.08741121,  1.0816521 ,
        1.08092997,  1.01479231,  0.97812276,  1.04503543,  1.02693868,
        1.00225189,  0.97836615,  0.93340727,  0.86393281,  0.77167049,
        0.64827101,  0.95904445]))
('det_covar_ln', 270.95691987660098)
('ln_one_div_root_two_pi_d_det_covar', -282.92282386022839)
('sum_X_sub_mean_div_covar', 3455.8954618930525)
('ln_res', -2010.8705548067546)
('res', 0.0)